# Config file for source/Simulation/SimulationMain/incompFlow

USESETUPVARS Grid

# Currently these simulations have not been tested with
# uniform grid so throw a setup error if it is requested.
# First perform a check using Grid setup variable
IF Grid == "UG"
    SETUPERROR incompFlow simulations are not compatible with uniform grid yet
ENDIF
# Add a conflict if above condition fails
CONFLICTS Grid/GridMain/UG

# Dependencies on poisson solver and specialized sub-units for
# handling divergence free interpolation of face-centered velocity
IF Grid in ["","PM4DEV","PM40","PM3","PM2"]
    REQUIRES Grid/GridMain/AMR/Paramesh4/Incomp
    REQUESTS Grid/GridSolvers/HYPRE
ENDIF

# Add dependencies for amrex-native multigrid poisson solver.
IF Grid == "Amrex"
    REQUIRES Grid/GridSolvers/AmrexMultigridSolver
ENDIF

# Common runtime parameters for optimization of guard-cell filling 
# operations which can be over-written in parfiles. Note that runtime 
# parameters are simply ignored if they are not available for a grid 
# implementation and have not been assigned under an IF statement.
PARAMETER enableMaskedGCFill BOOLEAN TRUE
PARAMETER convertToConsvdForMeshCalls BOOLEAN FALSE
PARAMETER convertToConsvdInMeshInterp BOOLEAN FALSE
PARAMETER gr_bcEnableApplyMixedGds BOOLEAN FALSE
PARAMETER gr_bndGCFillNeedsPrimitiveVars BOOLEAN FALSE
PARAMETER gr_sanitizeDataMode INTEGER 0
PARAMETER gr_gcFillSingleVarRange BOOLEAN FALSE

# Link specific refinement/derefinement routines based on 
# what Grid unit is being used for the simulation
LINKIF Grid_updateRefinement.F90 Grid/GridMain/AMR/Paramesh4
LINKIF Grid_markRefineDerefine.F90 Grid/GridMain/AMR/Paramesh4
LINKIF gr_markRefineDerefineCallback.F90 Grid/GridMain/AMR/Amrex

# A logical runtime parameter to run unitests on a simulation.
# Used in driver evolve at the end of evolution loop
PARAMETER sim_runTest BOOLEAN FALSE

# Pre-processor directive to define the simulation group
PPDEFINE SIMULATION_INCOMPFLOW
